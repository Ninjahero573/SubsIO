<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SubsIO - Your Music Companion</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/layout.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bento.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/nowplaying.css') }}">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <!-- connection indicator (replaces hamburger) -->
            <div id="connection-indicator" class="connection-indicator connecting" aria-live="polite" aria-label="Connection status">
                <span class="indicator-dot connecting" aria-hidden="true"></span>
                <span id="connection-text" class="connection-text connecting">Connecting...</span>
                <span class="sr-only">Connection status</span>
            </div>
            <div class="header-left">
                <h1>üé∂ SubsIO üéÆ</h1>
            </div>
            <div class="header-controls">
            </div>
        </header>



        <!-- Top notifications: floating toasts appear here -->
        <div id="top-notifications" class="top-notifications" aria-live="polite" aria-atomic="true"></div>

        <!-- Bento card: quick actions + playlists grouped together -->
        <div class="bento-card">
            <!-- Bento menu: quick actions including YouTube sign-in -->
            <div class="bento-grid" role="list" aria-label="Quick actions">
            <button class="bento-item" id="bento-search" type="button" role="listitem" aria-label="Search or add a song">
                <svg class="bento-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20l-6-6zM9.5 14A4.5 4.5 0 1 1 14 9.5 4.5 4.5 0 0 1 9.5 14z"/>
                </svg>
                <div class="bento-label">Search / Add</div>
            </button>

            <button class="bento-item youtube-login-btn" id="youtube-login-btn" role="listitem" aria-label="Sign in with YouTube" title="Sign in with YouTube">
                <img class="youtube-img" src="/images/youtube.jpg" alt="YouTube">
            </button>

            <a class="bento-item spotify-link" href="https://open.spotify.com" target="_blank" rel="noopener" role="listitem" aria-label="Open Spotify">
                <!-- Use shipped image asset for Spotify logo -->
                <img class="spotify-img" src="/images/spotify.jpg" alt="Spotify" />
            </a>

            <button class="bento-item" id="bento-queue" type="button" role="listitem" aria-label="Open queue" title="Open queue">
                <svg class="bento-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M3 6h18v2H3V6zm0 5h12v2H3v-2zm0 5h6v2H3v-2z"/>
                </svg>
                <div class="bento-label">Queue</div>
            </button>
            </div>

            <!-- YouTube Playlists Panel (grouped with bento) -->
            <section id="youtube-playlists-panel" class="youtube-panel">
                <div class="yt-column">
                    <h3>Your Playlists</h3>
                    <div id="yt-playlists" class="yt-playlists">
                        <div class="empty-state"><p>Sign in to YouTube to view playlists.</p></div>
                    </div>
                </div>
                <div class="yt-column">
                    <h3>Playlist Items</h3>
                    <div id="yt-playlist-items" class="yt-playlist-items">
                        <div class="empty-state"><p>Select a playlist to see songs.</p></div>
                    </div>
                </div>
            </section>
        </div>



        <section class="add-song-section">
            <h2>Add a Song (YouTube only right now)</h2>
            <form id="add-song-form">
                <div class="form-group">
                    <input 
                        type="text" 
                        id="song-or-search" 
                        placeholder="Paste YouTube URL or enter a search term..."
                    >
                    <div id="link-results" class="search-results"></div>
                    <div id="search-status" class="search-status"></div>
                    <div id="search-results" class="search-results"></div>
                    <button id="search-more-btn" type="button" class="search-more-btn" style="display: none;">Load More Results</button>
                </div>
                <div class="form-group">
                    <input 
                        type="text" 
                        id="added-by" 
                        placeholder="Your name (optional)"
                        maxlength="50"
                    >
                </div>
                <div class="form-group user-settings">
                    <span id="current-user" class="user-pill">Name: <strong>Anonymous</strong></span>
                    <button type="button" id="change-name-btn" class="link-btn" aria-label="Edit name">‚úé</button>
                    <button type="button" id="clear-name-btn" class="link-btn" aria-label="Clear name">‚úñ</button>
                    
                </div>
                <button type="submit" id="add-btn" class="primary-btn">
                    <span>üîç</span> Search
                </button>
            </form>
        </section>
    </div>



        <!-- Persistent Now Playing bar -->
        <div id="now-playing-bar" class="now-playing-bar">
            <div id="now-playing" class="now-playing-bar-left">
                <div class="np-thumb" id="np-thumb">
                    <img src="" alt="thumb" id="np-thumb-img" style="display:none;">
                </div>
                <div class="np-info">
                    <div id="np-title" class="np-title">No song currently playing</div>
                    <div id="np-artist" class="np-artist"></div>
                </div>
            </div>
            <div class="now-playing-bar-center">
                <div class="np-progress" id="np-progress">
                    <div class="np-progress-fill" id="np-progress-fill" style="width:0%"></div>
                </div>
            </div>
            <div class="now-playing-bar-right">
                <button id="np-toggle-queue-btn" class="control-btn" title="Show queue" aria-expanded="false">‚ò∞</button>
                <button id="play-pause-btn" class="control-btn play-pause" title="Play/Pause" aria-pressed="false"></button>
                <button id="skip-next-btn" class="control-btn skip" title="Next"></button>
            </div>
        </div>



        <!-- Expandable queue panel that appears above the bottom bar -->
        <div id="np-queue-panel" class="np-queue-panel" aria-hidden="true">
            <div class="np-queue-header">
                <div class="np-queue-title">Up Next (<span id="queue-count">0</span>)</div>
                <button id="np-close-queue-btn" class="link-btn" title="Close">‚úï</button>
            </div>
            <div id="np-queue-list" class="np-queue-list">
                <!-- Populated dynamically with the current queue -->
            </div>
        </div>

        
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
